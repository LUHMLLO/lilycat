@layer utils {
  :where(.grid) {
    /* local vars */
    --tmpl: 1;
    --gap: 0rem;
    --maxWidth: 1fr;
    --minWidth: clamp(12rem, 16vmin, 24rem);
    --repeat: auto-fill;
    display: grid;
    gap: var(--gap);
    grid-template-columns: repeat(var(--repeat),
        minmax(max(var(--minWidth), 100% / var(--tmpl) - var(--gap)),
          var(--maxWidth)));
    height: max-content;
  }

  :where(.grid).cols-1 {
    --tmpl: 1;
  }

  :where(.grid).cols-2 {
    --tmpl: 2;
  }

  :where(.grid).cols-3 {
    --tmpl: 3;
  }

  :where(.grid).cols-4 {
    --tmpl: 4;
  }

  :where(.grid).cols-5 {
    --tmpl: 5;
  }

  :where(.grid).cols-6 {
    --tmpl: 6;
  }

  :where(.grid).cols-7 {
    --tmpl: 7;
  }

  :where(.grid).cols-8 {
    --tmpl: 8;
  }

  :where(.grid).cols-9 {
    --tmpl: 9;
  }

  :where(.grid).cols-10 {
    --tmpl: 10;
  }

  :where(.grid).cols-11 {
    --tmpl: 11;
  }

  :where(.grid).cols-12 {
    --tmpl: 12;
  }

  :where(.grid).subgrid {
    grid-template-columns: subgrid;
    grid-template-rows: subgrid;
  }

  :where(.grid).container {
    grid-auto-rows: max-content;
    grid-template-columns: [expand-start] minmax(var(--prefers-containerOutterWidth),
        1fr) [contain-start] minmax(0, var(--prefers-containerWidth)) [contain-end] minmax(var(--prefers-containerOutterWidth),
        1fr) [expand-end];
  }

  :where(.grid).container > * {
    grid-column: contain;
  }

  :where(.grid).container > [tmpl-expand] {
    grid-column: expand;
  }

  :where(.grid).container > [tmpl-expand] > *:not([tmpl-expand='uncontained']) {
    /* (100vw - widthToMatch) / 2 , the min in the minmax() + the gap */
    padding-inline: max((100% - var(--prefers-containerWidth)) / 2,
        var(--prefers-containerOutterWidth) + 1px) !important;
  }

  :where(.grid).container > [tmpl-subgrid] {
    grid-auto-rows: inherit;
    grid-template-columns: 1/-1;
    grid-column: expand;
  }

  :where(.grid).container > [tmpl='row'] {
    grid-auto-flow: column;
    grid-auto-columns: minmax(0, 1fr);
  }

  :where(.grid).container > [tmpl='col'] {
    grid-auto-flow: row;
    grid-auto-rows: minmax(0, 1fr);
  }
}