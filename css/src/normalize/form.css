@layer normalize {

  /* buttons */
  :where(button, [type="button"]) {
    align-items: center;
    background-color: var(--clr-primary__base);
    border-radius: var(--xl);
    display: inline-flex;
    font: inherit;
    gap: var(--xs);
    height: 45px;
    line-height: 1;
    outline: solid 2px transparent;
    outline-offset: -2px;
    overflow: clip;
    padding: 0 var(--md);
    transition-property: background-color, color, filter, outline, outline-color, outline-offset;
    transition-duration: var(--animDuration);
    transition-timing-function: var(--animTiming);
    white-space: nowrap;
    width: fit-content;

    &:focus-visible {
      outline-color: var(--clr-accent__base);
    }

    &:hover {
      background-color: var(--clr-primary__raised);
    }

    &:active {
      background-color: var(--clr-primary__lowered);
    }

    /* Icon at the start */
    &:has(> :where(.icon, figure, kbd):first-child):not(:has(> :where(.icon, figure, kbd):last-child)) {
      padding-left: var(--sm);
    }

    /* Icon at the end */
    &:has(> :where(.icon, figure, kbd):last-child):not(:has(> :where(.icon, figure, kbd):first-child)) {
      padding-right: var(--sm);
    }

    /* Icons on both sides */
    &:has(> :where(.icon, figure, kbd):first-child):has(> :where(.icon, figure, kbd):last-child) {
      padding-left: var(--sm);
      padding-right: var(--sm);
    }

    &:has(> :where(.icon, figure, kbd):only-child) {
      aspect-ratio: 1/1;
      padding: 0;
      place-content: center;
    }

    &:where([data-roles~="outline"]) {
      background-color: transparent;
      color: var(--clr-primary__base);
      outline-color: var(--clr-primary__base);

      &:focus-visible {
        outline-color: var(--clr-primary__base);
      }

      &:hover {
        background-color: transparent;
        color: var(--clr-primary__raised);
        outline-color: var(--clr-primary__raised);
      }

      &:active {
        background-color: transparent;
        color: var(--clr-primary__lowered);
        outline-color: var(--clr-primary__lowered);
      }
    }

    &:where([data-roles~='flat']) {
      background-color: inherit;
      outline-color: transparent;

      &:focus-visible {
        outline-color: var(--clr-primary__base);
      }

      &:hover {
        background-color: transparent;
        color: var(--clr-primary__raised);
        outline-color: transparent;
      }

      &:active {
        background-color: transparent;
        color: var(--clr-primary__lowered);
        outline-color: transparent;
      }
    }
  }


  :where(meter, progress) {
    display: inline-block;
    height: 35px;
  }

  /*select*/
  :where(select, ::picker(select)) {
    appearance: base-select;
  }

  :where(select) {
    background-color: var(--clr-background__base);
    border-radius: var(--xs);
    color: var(--clr-text__base);
    display: inline-block;
    font-size: inherit;
    height: 45px;
    line-height: 1;
    outline: solid 2px var(--clr-border__base);
    outline-offset: -2px;
    overflow: clip;
    padding: 0 var(--md);
    place-items: center;
    transition-property: background-color,
      color,
      outline,
      outline-offset;
    transition-duration: var(--animDuration);
    transition-timing-function: var(--animTiming);
    white-space: nowrap;
    width: fit-content;

    &:focus-visible {
      outline-color: var(--clr-accent__base);
    }

    &::picker(select) {
      appearance: base-select;
      background-color: var(--clr-background__base);
      border-radius: var(--xs);
      flex-direction: column;
      border: solid 2px var(--clr-border__base);
      overflow-x: clip;
      overflow-y: auto;
      transition-property: opacity, visibility;
      transition-duration: var(--animDuration);
      transition-timing-function: var(--animTiming);
      transition-behavior: allow-discrete;
    }

    &:open::picker(select) {
      display: flex;
    }

    & > option {
      align-items: center;
      display: inline-flex;
      font: inherit;
      flex-shrink: 0;
      gap: var(--xs);
      height: 45px;
      line-height: 1;
      overflow: clip;
      padding: 0 var(--md);
      transition-property: background-color, color, filter, outline, outline-color, outline-offset;
      transition-duration: var(--animDuration);
      transition-timing-function: var(--animTiming);
      white-space: nowrap;
    }
  }

  /* inputs */
  :where(input) {
    background-color: var(--clr-background__base);
    border-radius: var(--xs);
    color: var(--clr-text__base);
    display: inline-block;
    font-size: inherit;
    height: 45px;
    line-height: 1;
    outline: solid 2px var(--clr-border__base);
    outline-offset: -2px;
    overflow: clip;
    padding: 0 var(--md);
    transition-property: background-color, color, outline, outline-offset;
    transition-duration: var(--animDuration);
    transition-timing-function: var(--animTiming);
    white-space: nowrap;
    width: fit-content;

    &:focus-visible {
      outline-color: var(--clr-accent__base);
    }
  }

  :where(input[type="color"]) {
    --size: var(--xl);

    appearance: none;
    aspect-ratio: 1/1;
    height: var(--size);
    padding: 0;
    width: var(--size);

    &::-webkit-color-swatch-wrapper {
      padding: 0;
    }

    &::-webkit-color-swatch {
      border: none;
    }
  }

  :where(input[type="checkbox"], input[type="radio"]) {
    --size: var(--nm);

    appearance: none;
    aspect-ratio: 1/1;
    background-color: var(--clr-background__base);
    contain: content;
    display: inline-grid;
    flex: 0 0 max-content;
    height: var(--size);
    padding: 0;
    touch-action: manipulation;
    transition-property: color, height, font-size, width;
    transition-duration: var(--animDuration);
    transition-timing-function: var(--animTiming);
    user-select: none;
    vertical-align: text-bottom;
    width: var(--size);

    &:checked {
      background-color: var(--clr-accent__base);
    }
  }

  :where(input[type="radio"]) {
    border-radius: 50%;
  }

  :where(input[type="range"]) {
    --track-height: .5ex;
    --thumb-size: 3ex;
    --thumb-offset: -1.25ex;

    appearance: none;
    background: transparent;
    display: block;
    inline-size: 100%;
    outline: none;
    padding: 0;

    &::-webkit-slider-runnable-track {
      appearance: none;
      background-color: var(--clr-border__base);
      block-size: var(--track-height);
      border-radius: 5ex;
      cursor: pointer;
    }

    &::-webkit-slider-thumb {
      appearance: none;
      background-color: var(--clr-primary__base);
      block-size: var(--thumb-size);
      border-radius: 50%;
      cursor: ew-resize;
      inline-size: var(--thumb-size);
      margin-top: var(--thumb-offset);
      transition-property: background-color;
      transition-duration: var(--animDuration);
      transition-timing-function: var(--animTiming);

      &:hover {
        background-color: hsl(from var(--clr-primary__raised) h s calc(l + var(--ratio-backgrounds)));
      }

      &:active {
        background-color: hsl(from var(--clr-primary__lowered) h s calc(l - var(--ratio-backgrounds)));
      }
    }
  }

  /* textarea */
  :where(textarea) {
    background-color: var(--clr-background__base);
    border-radius: var(--xs);
    color: var(--clr-text__base);
    display: inline-block;

    -moz-field-sizing: content;
    -webkit-field-sizing: content;
    field-sizing: content;

    font-size: inherit;

    min-height: 75px;

    outline: solid 2px var(--clr-border__base);
    outline-offset: -2px;
    overflow: clip;
    padding: var(--md);
    resize: both;

    transition-property: background-color, color, outline, outline-offset;
    transition-duration: var(--animDuration);
    transition-timing-function: var(--animTiming);
    width: 100%;

    &:focus-visible {
      outline-color: var(--clr-accent__base);
    }
  }
}